<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="java">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="/bootstrap-5.3.2-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assests/css/style.css">
    <link rel="shortcut icon" href="/assests/srcPic/x.png" type="image/x-icon">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script th:src="@{/assests/js/UserManagement.js}"></script>

    <style>
        .max-width-col {
            max-width: 128px;
        }
    </style>

    <style>
        #fileInput {
            display: none;
        }

        .custom-file-label {
            cursor: pointer;
            padding: 10px 20px;
            background-color: #909498;
            color: #fff;

        }

        .custom-file-label:hover {
            background-color: #9a9fa4;
        }

        #previewImage {
            width: 200px;
            height: 200px;
            object-fit: cover;
            margin-top: 20px;
        }

        #previewImage1 {
            width: 200px;
            height: 200px;
            object-fit: cover;
            margin-top: 20px;
        }
    </style>

    <script>
        const services = new UserManagement();
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            console.log("Test kinda done")
            services.loadInit();
        })
    </script>
</head>

<body class="bg-black" ng-app="myApp" ng-Controller="AdminController">
<div class="d-block d-lg-none">
    <div id="mobileNav" style="color: rgb(231,227,223);">
        <nav class="navbar  navbar-expand-lg navbar-dark" aria-label="Mobile Navigation">
            <div class="container-sm">

                <button type="button" class="navbar-toggler" data-bs-toggle="offcanvas" data-bs-target="#slide_menu"
                        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa-solid fa-bars"></i>
                </button>

                <a href="#" class="navbar-brand" title="Swappa">
                    <img class="img-fluid"
                         src="https://static.swappa.com/static/images/logos/swappa_wordmark_ffffff_drop_e4611b.svg"
                         alt="Swappa Logo">
                </a>

                <button type="button" class="navbar-toggler" data-bs-toggle="offcanvas"
                        data-bs-target="#slide_search" aria-controls="navbarSupportedContent" aria-expanded="false"
                        aria-label="Search">
                    <i class="fa-solid fa-search" aria-hidden="true"></i>
                </button>
            </div>
        </nav>
    </div>

</div>
<!-- mainNav -->
<div class="d-none d-lg-block">
    <!-- first-nav -->
    <div class="stNav" style="color: rgb(231,227,223);">
        <nav class="navbar navbar-expand-lg  navbar-dark">
            <div class="container d-block">
                <div class="d-flex justify-content-between align-items-center">
                    <ul class="navbar-nav" role="presentation">
                        <li class="nav-item">
                            <a class="navbar-brand d-block text-center pt-2" href="#">
                                <img class="img-fluid"
                                     src="https://static.swappa.com/static/images/logos/swappa_wordmark_ffffff_drop_e4611b.svg"
                                     width="167px" height="35px" alt="Bootstrap">
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav" role="presentation">


                        <li class="nav-item">
                            <a href="#!/cart" class="nav-link position-relative">

                                <i class="fa-solid fa-bell"></i>
                                <span ng-bind="cartLen"
                                      class="position-absolute top-0 start-100 translate-middle-x px-2 text-bg-cf badge rounded-pill">
                                        1 <span class="visually-hidden">Cart Items</span>
                                    </span>

                            </a>
                        </li>
                    </ul>
                </div>

            </div>
        </nav>
    </div>
</div>

<div class="container-fluid  bg-body-secondary" style="height: 800px;">
    <div class="row">
        <div class="col-xl-3 col-lg-12 mt-4">
            <div class="card">
                <div class="card-header bg-black text-center">
                    <a class="text-white bg-gradient-primary" href="../pages/tables.html">
                        <h5 class="m-0"><strong>USERS MANAGEMENT</strong></h5>
                    </a>
                </div>
                <div class="card-body pt-2">
                    <div class="align-items-start">
                        <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist"
                             aria-orientation="vertical">
                            <button class="nav-link mt-1 text-black active" id="v-pills-home-tab"
                                    data-bs-toggle="pill" data-bs-target="#v-pills-home" type="button" role="tab"
                                    aria-controls="v-pills-home" aria-selected="true">Account Information
                            </button>
                            <button class="nav-link mt-1 text-black" id="v-pills-home-product"
                                    data-bs-toggle="pill" data-bs-target="#v-pills-product" type="button" role="tab"
                                    aria-controls="v-pills-product" aria-selected="false">ACCESS PRODUCT
                            </button>
                            <button class="nav-link mt-1 text-black" id="v-pills-home-sale"
                                    data-bs-toggle="pill" data-bs-target="#v-pills-sale" type="button" role="tab"
                                    aria-controls="v-pills-sale" aria-selected="false">SALE AND PRODUCT
                            </button>
                            <button class="nav-link mt-1 text-black" id="v-pills-home-voucher"
                                    data-bs-toggle="pill" data-bs-target="#v-pills-voucher" type="button" role="tab"
                                    aria-controls="v-pills-voucher" aria-selected="false">VOUCHER ACCOUNT
                            </button>
                            <a class="nav-link mt-1 text-black" href="/admin/logout">Log Out
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-9 col-lg-12">
            <div class="tab-content" id="v-pills-tabContent">
                <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                     aria-labelledby="v-pills-home-tab" tabindex="0">
                    <div class="card my-4">
                        <div class="card-header p-0 bg-dark-subtle position-relative mt-2 mx-3 z-index-2">
                            <div
                                    class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3 d-flex justify-content-between">
                                <h5 class="text-black ps-3 d-flex align-items-center mb-0">SYSTEM'S USERS
                                </h5>
                                <button type="button" class="btn btn-success mb-0 me-3 rounded-circle sidenav"
                                        data-bs-target="#exampleModalToggle" data-bs-toggle="modal"
                                        style="padding: 7px 12px 7px 12px;">
                                    <i class="fa-solid fa-plus " aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body px-0 mx-3 pb-2">
                            <div class="table-responsive p-0" id="tableUserContainer">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="v-pills-product" role="tabpanel"
                     aria-labelledby="v-pills-home-product" tabindex="0">
                    <div class="card my-4">
                        <div class="card-header p-0 bg-dark-subtle position-relative mt-2 mx-3 z-index-2">
                            <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3 d-flex justify-content-between">
                                <h5 class="text-black ps-3 d-flex align-items-center mb-0">ACCESS PRODUCT
                                </h5>
                                <button type="button" class="btn btn-success mb-0 me-3 rounded-circle sidenav"
                                        data-bs-target="#exampleModalToggle" data-bs-toggle="modal"
                                        style="padding: 7px 12px 7px 12px;">
                                    <i class="fa-solid fa-plus " aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body px-0 mx-3 pb-2">

                            <!--viết body vào đây-->
                            <div class="table-responsive p-0" id="tableAccessProductContainer">

                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="v-pills-sale" role="tabpanel"
                     aria-labelledby="v-pills-home-sale" tabindex="0">
                    <div class="card my-4">
                        <div class="card-header p-0 bg-dark-subtle position-relative mt-2 mx-3 z-index-2">
                            <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3 d-flex justify-content-between">
                                <h5 class="text-black ps-3 d-flex align-items-center mb-0">SALE AND PRODUCT MANAGEMENT
                                </h5>
                                <button type="button" class="btn btn-success mb-0 me-3 rounded-circle sidenav"
                                        data-bs-target="#exampleModalToggleProduct" data-bs-toggle="modal"
                                        style="padding: 7px 12px 7px 12px;">
                                    <i class="fa-solid fa-plus " aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body px-0 mx-3 pb-2">

                            <!--viết body vào đây Lộc-->
                            <div class="table-responsive p-0" id="tableSaleContainer">
                                <table class="table align-items-center mb-0">
                                    <thead>
                                    <tr class="text-center">
                                        <th scope="col" class="max-width-column"></th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Price</th>
                                        <th scope="col">Quantity</th>
                                        <th scope="col"></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="max-width-column">
                                            <div class="d-flex py-1 justify-content-center">
                                                <div>
                                                    <!--Hình của sản phầm... 1 hình avatar product-->
                                                    <img src="" class="avatar avatar-sm border-radius-lg" alt="">
                                                </div>
                                            </div>
                                        </td>
                                        <td class="align-middle text-center text-sm">
                                            <div class="d-flex w-100 flex-column justify-content-center">
                                                <h6 class="mb-0 text-sm">Sản phẩm 1</h6>
                                            </div>
                                        </td>
                                        <td class="align-middle text-center text-sm">
                                            <span class="text-secondary text-xs font-weight-bold">20$</span>
                                        </td>
                                        <td class="align-middle text-center">
                                            <span class="text-secondary text-xs font-weight-bold">199999</span>
                                        </td>

                                        <td class="align-middle text-center">
                                            <button class="btn border-0 rounded btn-outline-info"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalUpdateProduct">
                                                <i class="fa-solid fa-pen-to-square"></i></button>
                                            <button class="border border-0 rounded btn-outline-danger"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalDeleteProduct">
                                                <i class="fa-solid fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="v-pills-voucher" role="tabpanel"
                     aria-labelledby="v-pills-home-voucher" tabindex="0">
                    <div class="card my-4">
                        <div class="card-header p-0 bg-dark-subtle position-relative mt-2 mx-3 z-index-2">
                            <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3 d-flex justify-content-between">
                                <h5 class="text-black ps-3 d-flex align-items-center mb-0">VOUCHER ACCOUNT
                                </h5>
                                <button type="button" class="btn btn-success mb-0 me-3 rounded-circle sidenav"
                                        data-bs-target="#exampleModalToggleVoucher" data-bs-toggle="modal" id="newInsButtonAccount"
                                        style="padding: 7px 12px 7px 12px;">
                                    <i class="fa-solid fa-plus " aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body px-0 mx-3 pb-2">

                            <!--viết body vào đây VOUCHER ACCOUNT-->
                            <div class="table-responsive p-0" id="tableVoucherContainer">
                                <table class="table align-items-center mb-0">
                                    <thead>
                                    <tr class="text-center">
                                        <th scope="col">Voucher Name</th>
                                        <th scope="col">Reduce</th>
                                        <th scope="col">Start Day</th>
                                        <th scope="col">End Day</th>
                                        <th scope="col"></th>
                                    </tr>
                                    </thead>
                                    <tbody id="voucherTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--==================================================MODAL ACCOUNT INFORMATION==============================================-->
<!--insert modal Account Information-->
<div class="modal fade modal-lg" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="insertedUserModal">User's Information</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="insertModalBody">
                <div class="mb-2 ">
                    <label for="inUsername" class="form-label">Username</label>
                    <input type="text" class="form-control ps-3" id="inUsername"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="inFullname" class="form-label">Fullname</label>
                    <input type="text" class="form-control ps-3" id="inFullname"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="inEmail" class="form-label">Email</label>
                    <input type="email" class="form-control ps-3" id="inEmail"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>

                <div class="mb-2 ">
                    <label for="inPass" class="form-label">Password</label>
                    <input type="password" class="form-control ps-3" id="inPass" aria-describedby=""
                           style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="inConfirmPass" class="form-label">Confirm password</label>
                    <input id="inConfirmPass" class="form-control ps-3 pe-3" type="password"
                           style="border: 1px solid #d2d6da;">

                </div>
                <div class="mb-2 ">
                    <label for="inRole" class="form-label me-3 m-0">Role</label>
                    <select class="form-select" id="inRole" aria-label="Default select example">
                        <option value="1">Admin</option>
                        <option value="2">Manager</option>
                        <option value="3">User</option>
                    </select>
                </div>
                <div class="mb-2">
                    <label for="inDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="inDescription" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-bs-dismiss="modal"
                        onclick="services.insertNewUser()">
                    Add new user
                </button>
            </div>
        </div>
    </div>
</div>


<!-- modal sửa Account Information-->
<div class="modal fade modal-lg" id="exampleModalSua1" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="updateUserModal">User's Infomation</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="updateUserModalBody">


            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="services.updateUser()">
                    Save changes
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Modal xóa Account Information-->
<div class="modal fade" id="exampleModalXoa" tabindex="-1" aria-labelledby="exampleModalXoa" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Confirm delete user?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">Are your sure to delete this user out of your system?</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" data-bs-dismiss="modal" onclick="services.disableUser()">
                    I'm sure!
                </button>
            </div>
        </div>
    </div>
</div>
<!--========================================SALE AND PRODUCT MANAGEMENT<=====================================================-->
<!--insert modal PRODUCT MANAGEMENT<-->
<div class="modal fade modal-lg" id="exampleModalToggleProduct" aria-hidden="true"
     aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="insertProductModal">SALE AND PRODUCT MANAGEMENT</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="insertProductModalBody">
                <div class="row">
                    <div class="col-8">
                        <div class="mb-2 ">
                            <label for="insNameProduct" class="form-label">Name</label>
                            <input type="text" class="form-control ps-3" id="insNameProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2 ">
                            <label for="insPriceProduct" class="form-label">Price</label>
                            <input type="text" class="form-control ps-3" id="insPriceProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2 ">
                            <label for="insQuantityProduct" class="form-label">Quantity</label>
                            <input type="text" class="form-control ps-3" id="insQuantityProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2">
                            <label for="inDescriptionProduct" class="form-label">Description</label>
                            <textarea class="form-control" id="inDescriptionProduct" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="container " style="">
                            <div class="d-flex justify-content-center">
                                <img src="" class="avatar me-3 border-radius-lg"
                                     id="previewImage" alt="Ảnh đã chọn">
                            </div>
                            <div class="text-center my-3" style="margin-right: 10px;">
                                <input type="file" class="form-control" id="fileInput" accept="" onchange="">
                                <label class="custom-file-label" for="fileInput">Chọn ảnh từ local</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-bs-dismiss="modal">
                    Add new Product
                </button>
            </div>
        </div>
    </div>
</div>
<!-- modal sửa Product-->
<div class="modal fade modal-lg" id="exampleModalUpdateProduct" aria-hidden="true"
     aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="updateProductModal">Product</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="updateProductModalBody">
                <div class="row">
                    <div class="col-8">
                        <div class="mb-2 ">
                            <label for="insNameProduct" class="form-label">Name</label>
                            <input type="text" class="form-control ps-3" id="updateNameProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2 ">
                            <label for="insPriceProduct" class="form-label">Price</label>
                            <input type="text" class="form-control ps-3" id="updatePriceProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2 ">
                            <label for="insQuantityProduct" class="form-label">Quantity</label>
                            <input type="text" class="form-control ps-3" id="updateQuantityProduct"
                                   aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                        </div>
                        <div class="mb-2">
                            <label for="inDescriptionProduct" class="form-label">Description</label>
                            <textarea class="form-control" id="updateDescriptionProduct" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="container " style="">
                            <div class="d-flex justify-content-center">
                                <img src="" class="avatar me-3 border-radius-lg"
                                     id="previewImage1" alt="Ảnh đã chọn">
                            </div>
                            <div class="text-center my-3" style="margin-right: 10px;">
                                <input type="file" class="form-control" id="fileInput1" accept="" onchange="">
                                <label class="custom-file-label" for="fileInput1">Chọn ảnh từ local</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="">
                    Save changes
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Modal xóa Product-->
<div class="modal fade" id="exampleModalDeleteProduct" tabindex="-1" aria-labelledby="exampleModalXoa"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="DeleteProductModal">Confirm delete Product?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">Are your sure to delete this user out of your system?</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" data-bs-dismiss="modal" onclick="">
                    I'm sure!
                </button>
            </div>
        </div>
    </div>
</div>
<!--====================================================Voucher==============================================================-->
<!--insert modal Voucher Acount<-->
<div class="modal fade modal-lg" id="exampleModalToggleVoucher" aria-hidden="true"
     aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="insertVoucherModal">VOUCHER ACOUNT</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="insertVoucherModalBody">
                <div class="mb-2 ">
                    <label for="insNameProduct" class="form-label">Name</label>
                    <input type="text" class="form-control ps-3" id="insNameVoucher"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="insReduce" class="form-label">Reduce</label>
                    <input type="number" min="1" max="100" class="form-control ps-3" id="insReduce"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="insStartDay" class="form-label">Start Day</label>
                    <input type="date" class="form-control ps-3" id="insStartDay"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="mb-2 ">
                    <label for="insEndDay" class="form-label">End Day</label>
                    <input type="date" class="form-control ps-3" id="insEndDay"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                </div>
                <div class="" role="alert" id="alertMessVoucher">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success"  id="insButtonVoucher">
                    Add New Voucher
                </button>
            </div>
        </div>
    </div>
</div>
<!-- modal sửa Product-->
<div class="modal fade modal-lg" id="exampleModalUpdateVoucher" aria-hidden="true"
     aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="updateVoucherModal">Product</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="updateVoucherModalBody">
                <div class="mb-2 ">
                    <label for="updateIDVoucher" class="form-label">ID Voucher</label>
                    <input type="text" class="form-control ps-3" id="updateIDVoucher" disabled
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;" >
                    <label for="updateNameVoucher" class="form-label">Name Voucher</label>
                    <input type="text" class="form-control ps-3" id="updateNameVoucher"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                    <label for="updateReduceVoucher" class="form-label">Reduce</label>
                    <input type="number" min="0" max="100" class="form-control ps-3" id="updateReduceVoucher"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                    <label for="updateStartDayVoucher" class="form-label">Start Day</label>
                    <input type="date" class="form-control ps-3" id="updateStartDayVoucher"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                    <label for="updateEndDayVoucher" class="form-label">Name Voucher</label>
                    <input type="date" class="form-control ps-3" id="updateEndDayVoucher"
                           aria-describedby="basic-addon3 basic-addon4" style="border: 1px solid #d2d6da;">
                    <div class="" role="alert" id="alertMessVoucherUpdate">
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="buttonUpdateVoucher">
                    Save changes
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Modal xóa Voucher-->
<div class="modal fade" id="exampleModalDeleteVoucher" tabindex="-1" aria-labelledby="exampleModalXoa"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="DeleteVoucherModal">Confirm delete Voucher?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">Are your sure to delete this user out of your system?</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" data-bs-dismiss="modal" onclick="">
                    I'm sure!
                </button>
            </div>
        </div>
    </div>
</div>
<!--===========================================Select voucher for user=======================================================-->
<div class="modal fade modal-lg" id="exampleModalVoucherSendAcount" aria-hidden="true"
     aria-labelledby="exampleModalToggleLabel"
     tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="VoucherModalSendAcount">Select voucher for user</h1>
                <button type="button" class="btn m-0" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark fa-xl" aria-hidden="true"></i></button>
            </div>
            <div class="modal-body" id="VoucherSendAcountModalBody">
                <table class="table align-items-center mb-0">
                    <thead>
                    <tr class="text-center">
                        <th scope="col">UserName</th>
                        <th scope="col">FullName</th>
                        <th scope="col">Email</th>
                        <th scope="col">Phone</th>
                        <th scope="col"></th>
                    </tr>
                    </thead>
                    <tbody id="userOnVoucher">

                    </tbody>
                </table>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="">
                    SEND
                </button>
            </div>
        </div>
    </div>
</div>
<!--=========================================================================================================================-->
<!-- footer -->
<footer style="background-color: rgb(18,17,13); color: rgb(231,227,223);">
    <div class="container pt-2 pb-2">
        <div class="row row-cols-2 row-cols-md-3 row-cols-lg-6">

        </div>
        <div class="row row-cols-1 row-cols-md-3">
            <div class="col d-flex justify-content-center align-items-center">
                <div class=" text-white">
                    <a href="https://www.facebook.com/profile.php?id=100031628760243" style="color: white">
                        <i class="fa-brands fa-square-facebook fs-1"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=100031628760243" style="color: white">
                        <i class="fa-brands fa-square-instagram fs-1"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=100031628760243" style="color: white">
                        <i class="fa-brands fa-youtube fs-1"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=100031628760243" style="color: white">
                        <i class="fa-brands fa-linkedin fs-1"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=100031628760243" style="color: white">
                        <i class="fa-brands fa-square-reddit fs-1"></i>
                    </a>
                </div>
            </div>
            <div class="col text-center ">
                <a href="./index.html"><img
                        src="https://static.swappa.com/static/images/logos/swappa_wordmark_ffffff.svg"
                        class="img-fluid" alt=""></a>
            </div>
            <div class="col text-center text-white d-flex justify-content-center align-items-center">
                <p class="fs-5">Copyright © 2023-2024 -M2M-</p>
            </div>
        </div>

    </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script src="/node_modules/angular/angular.min.js"></script>
<script src="/bootstrap-5.3.2-dist/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/c22bed0de0.js" crossorigin="anonymous"></script>
<script src="/node_modules/angular/angular.route.min.js"></script>
<script src="/assests/js/app_admin.js"></script>
<script src="/assests/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>



<!--đọc ảnh cho insert product-->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Lắng nghe sự kiện khi người dùng chọn file
        document.getElementById("fileInput").addEventListener("change", function () {
            // Lấy ra đối tượng file đã chọn
            var file = this.files[0];

            // Kiểm tra xem file có tồn tại không
            if (file) {
                // Tạo một đối tượng FileReader để đọc file
                var reader = new FileReader();

                // Lắng nghe sự kiện khi FileReader đã đọc xong file
                reader.onload = function (e) {
                    // Hiển thị ảnh đã chọn lên giao diện
                    document.getElementById("previewImage").src = e.target.result;
                };

                // Đọc file như một đường dẫn URL dạng Data URL
                reader.readAsDataURL(file);
            }
        });
    });
</script>
<!--đọc ảnh cho update product-->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Lắng nghe sự kiện khi người dùng chọn file
        document.getElementById("fileInput1").addEventListener("change", function () {
            // Lấy ra đối tượng file đã chọn
            var file = this.files[0];

            // Kiểm tra xem file có tồn tại không
            if (file) {
                // Tạo một đối tượng FileReader để đọc file
                var reader = new FileReader();

                // Lắng nghe sự kiện khi FileReader đã đọc xong file
                reader.onload = function (e) {
                    // Hiển thị ảnh đã chọn lên giao diện
                    document.getElementById("previewImage1").src = e.target.result;
                };

                // Đọc file như một đường dẫn URL dạng Data URL
                reader.readAsDataURL(file);
            }
        });
    });
</script>
<script>

    $(document).ready(function () {
        function getAllVoucher() {
            $.ajax({
                url: '/api-public/vouchers/getAllVouchers',
                type: 'GET',
                success: function (data) {
                    console.log(data);
                    $('#voucherTableBody').empty();
                    // Định dạng ngày bằng Moment.js

                    $.each(data,function (index,voucher){
                        var formattedStartDate = moment(voucher.startDay).format('DD-MM-YYYY');
                        var formattedEndDate = moment(voucher.endDay).format('DD-MM-YYYY');
                        var newRow = `
                            <tr>
                                <td class="align-middle text-center text-sm">
                                            <div class="d-flex w-100 flex-column justify-content-center">
                                                <h6 class="mb-0 text-sm">${voucher.voucherName}</h6>
                                            </div>
                                </td>
                                <td class="align-middle text-center text-sm">
                                            <span class="text-secondary text-xs font-weight-bold">${voucher.reduce}%</span>
                                </td>
                                <td class="align-middle text-center">
                                            <span class="text-secondary text-xs font-weight-bold">${formattedStartDate}</span>
                                </td>
                                <td class="align-middle text-center">
                                            <span class="text-secondary text-xs font-weight-bold">${formattedEndDate}</span>
                                </td>
                                <td class="align-middle text-center">
                                    <button class="btn border-0 rounded btn-outline-info" id="buttonUserOnVoucher" data-voucher-id="${voucher.voucherID}"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalVoucherSendAcount">
                                                <i class="fa-solid fa-ticket"></i></button>
                                    <button class="btn border-0 rounded btn-outline-info" id="updateVoucherButton" data-voucher-id="${voucher.voucherID}"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalUpdateVoucher">
                                                <i class="fa-solid fa-pen-to-square"></i></button>
                                    <button class="border border-0 rounded btn-outline-danger"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalDeleteVoucher">
                                        <i class="fa-solid fa-trash"></i></button>
                                </td>
                            </tr>
                            `;
                        $('#voucherTableBody').append(newRow);
                    });

                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        $('#v-pills-home-voucher').click(function () {
            getAllVoucher(); // Gọi hàm updateUser() khi nhấn vào nút "Submit"
        });

        function saveVoucher() {
            var voucherName = $('#insNameVoucher').val();
            var reduce = $('#insReduce').val();
            var startDay = $('#insStartDay').val();
            var endDay = $('#insEndDay').val();
            var startDate = new Date(startDay);
            var endDate = new Date(endDay);
            if(voucherName === '' || reduce === '' || startDay === '' || endDay === ''){
                $('#alertMessVoucher').text("Vui lòng nhập đâỳ đủ các trường").addClass("mb-2 alert alert-danger");
                return;
            }
            else if (startDate > endDate) {
                // startDay lớn hơn endDay
                $('#alertMessVoucher').text("Vui lòng nhập Start Day bé hơn End Day").addClass("mb-2 alert alert-danger");
                return;
            }
            // Nếu không có lỗi, loại bỏ lớp CSS alert-danger nếu có
            $('#alertMessVoucher').text("").removeClass("mb-2 alert alert-danger");

            let voucherData = {
                voucherName: voucherName,
                reduce: reduce,
                startDay: startDay,
                endDay: endDay,
            };

            $.ajax({
                url: '/api-public/vouchers/saveVoucher',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(voucherData),
                success: function (response) {
                    console.log(response === 1 ? 'Thêm thành công' : 'Thêm thất bại');
                    getAllVoucher();
                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        $('#insButtonVoucher').click(function () {
            saveVoucher();
        });
        $('#newInsButtonAccount').click(function () {
            $('#insNameVoucher').val('');
            $('#insReduce').val('');
            $('#insStartDay').val('');
            $('#insEndDay').val('');
        });
        function getVoucherByID(voucherID) {
            $.ajax({
                url: '/api-public/vouchers/getVoucherByID',
                type: 'GET',
                data: {
                    "voucherID": voucherID
                },
                success: function (data) {
                    $('#updateNameVoucher').val(data.voucherName);
                    $('#updateReduceVoucher').val(data.reduce);
                    $('#updateStartDayVoucher').val(data.startDay);
                    $('#updateEndDayVoucher').val(data.endDay);
                    $('#updateIDVoucher').val(data.voucherID);
                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        $(document).on('click', '#updateVoucherButton', function() {
            var voucherID = $(this).attr('data-voucher-id');
            getVoucherByID(voucherID);
        });


        function updateVoucher() {
            var voucherID = $('#updateIDVoucher').val();
            var voucherName = $('#updateNameVoucher').val();
            var reduce = $('#updateReduceVoucher').val();
            var startDay = $('#updateStartDayVoucher').val();
            var endDay = $('#updateEndDayVoucher').val();
            var startDate = new Date(startDay);
            var endDate = new Date(endDay);
            if(voucherName === '' || reduce === '' || startDay === '' || endDay === ''){
                $('#alertMessVoucherUpdate').text("Vui lòng nhập đâỳ đủ các trường").addClass("mb-2 alert alert-danger");
                return;
            }
            else if (startDate > endDate) {
                // startDay lớn hơn endDay
                $('#alertMessVoucherUpdate').text("Vui lòng nhập Start Day bé hơn End Day").addClass("mb-2 alert alert-danger");
                return;
            }
            // Nếu không có lỗi, loại bỏ lớp CSS alert-danger nếu có
            $('#alertMessVoucherUpdate').text("").removeClass("mb-2 alert alert-danger");

            let voucherData = {
                voucherID: voucherID,
                voucherName: voucherName,
                reduce: reduce,
                startDay: startDay,
                endDay: endDay,
            };

            $.ajax({
                url: '/api-public/vouchers/updateVoucher',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(voucherData),
                success: function (response) {
                    console.log(response === 1 ? 'Cập nhật thành công' : 'Cập nhật thất bại');
                    getAllVoucher();
                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        $('#buttonUpdateVoucher').click(function () {
            updateVoucher();
        });

        //load all user ở voucher
        var allUser = [];
        var listUserByVoucherID = [];
        function getAllUser() {
            $.ajax({
                url: '/api-public/users/getAllUsers',
                type: 'GET',
                success: function (data) {
                     allUser = [];
                    allUser.push(data);
                    console.log(allUser);
                    $('#userOnVoucher').empty();

                    $.each(data,function (index,u){
                        var newRow = `
                                <tr>
                        <td class="align-middle text-center text-sm">
                            <div class="d-flex w-100 flex-column justify-content-center">
                                <h6 class="mb-0 text-sm">${u.username}</h6>
                            </div>
                        </td>
                        <td class="align-middle text-center text-sm">
                            <div class="d-flex w-100 flex-column justify-content-center">
                                <h6 class="mb-0 text-sm">${u.fullname}</h6>
                            </div>
                        </td>
                        <td class="align-middle text-center text-sm">
                            <span class="text-secondary text-xs font-weight-bold">${u.email}</span>
                        </td>
                        <td class="align-middle text-center">
                            <span class="text-secondary text-xs font-weight-bold">${u.sdt}</span>
                        </td>

                        <td class="align-middle text-center">
                            <div class="form-check">
                               <input class="form-check-input" type="checkbox"  data-username="${u.username}" id="flexCheckCheckedVoucher_${u.id}">
                                <label class="form-check-label" for="flexCheckCheckedVoucher">
                                    Voucher
                                </label>
                            </div>
                        </td>
                    </tr>
                            `;
                        $('#userOnVoucher').append(newRow);
                    });

                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        function getListUserNotInVoucher(voucherID) {
            $.ajax({
                url: '/api-public/users/getListUserByVoucherID',
                type: 'GET',
                data: {
                    "voucherID": voucherID
                },
                success: function (data) {
                    listUserByVoucherID = [];
                    listUserByVoucherID.push(data);
                    console.log(listUserByVoucherID);
                    compareAndMarkUsers(allUser, listUserByVoucherID);
                },
                error: function (xhr, status, error) {
                    console.error("Đã xảy ra lỗi khi gọi API: " + error);
                }
            });
        }
        function compareAndMarkUsers(allUsers, usersNotInVoucher) {
            if (allUsers.length === 0 || usersNotInVoucher.length === 0) {
                console.log("Không nhận được dữ liệu từ API.");
                return;
            }

            // Lặp qua tất cả các người dùng trong mảng allUsers
            allUsers[0].forEach(function(user) {
                var found = false;

                // Kiểm tra xem người dùng có trong danh sách không thuộc voucher không
                usersNotInVoucher[0].forEach(function(userNotInVoucher) {
                    if (user.username === userNotInVoucher.username) {
                        found = true;
                        return; // Thoát khỏi vòng lặp nếu tìm thấy người dùng
                    }
                });

                // Xác định phần tử checkbox tương ứng với người dùng
                var checkboxElement = $('input[data-username="' + user.username + '"]');

                if (checkboxElement.length > 0) { // Kiểm tra xem phần tử có tồn tại hay không
                    checkboxElement.prop('checked', !found); // Đánh dấu checkbox dựa trên kết quả tìm kiếm
                } else {
                    console.warn("Không tìm thấy phần tử checkbox cho người dùng:", user.username);
                }
            });
        }

        $(document).on('click', '#buttonUserOnVoucher', function() {
            getAllUser();
            var voucherID = $(this).attr('data-voucher-id');
            getListUserNotInVoucher(voucherID);
        });

    });

</script>

</body>

<!--<script>-->
<!--    $.ajax({-->
<!--        url: '/api-admin/users/getAllUsers',-->
<!--        method: 'GET',-->
<!--        success: (response) => {-->
<!--            console.log(response);-->
<!--        },-->
<!--        error: (xhr, status, error) => {-->
<!--            console.error("Error:", error);-->
<!--        }-->
<!--    });-->
<!--</script>-->
<!--<script>-->
<!--    document.getElementById('fileInput').addEventListener('change', function () {-->
<!--        var file = this.files[0];-->
<!--        if (file) {-->
<!--            var reader = new FileReader();-->
<!--            reader.onload = function (event) {-->
<!--                document.getElementById('previewImage').setAttribute('src', event.target.result);-->
<!--                document.getElementById('previewImage').style.display = 'block';-->
<!--            }-->
<!--            reader.readAsDataURL(file);-->
<!--        }-->
<!--    });-->
<!--</script>-->

</html>